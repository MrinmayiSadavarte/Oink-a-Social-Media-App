<!-- <!DOCTYPE html> -->
<!-- 'ng' refers to AngularJS -->

<html ng-app="oink">
<head>
	<title>Oink</title>
	<link rel="stylesheet" type="text/css" href="bootstrap/css/bootstrap.css">
	<link rel="stylesheet" type="text/css" href="style.css">
	<script type="text/javascript" src="angular.min.js"></script>
	<script type="text/javascript">
		
		var app = angular.module('oink', []);
		
		/*Oink AngularJS Controller. 1st argumet : Name of Controller, 2nd argument : actual functionality, $scope is a service in AngularJS across web pages*/
		app.controller('OinkCtrl', function($scope, $http) {
			
			/****IMP: sending data to server from frontend; JSON object in curly brackets i.e variable and it's property
			// As soon as a post is submitted using Submit button, it is stored in the database and getPosts() function
			is called to print the post automatically on-the-go */
			
			$scope.submitNewPost = function() {
				$http.post('/posts', {newPost: $scope.newPost}).then(function() {
					getPosts();
					$scope.newPost = '';
				});
			};


			$scope.removePost = function(deletepost) {
				$http.put('/posts/remove', {post: deletepost}).then(function() {
					getPosts();
				});
			};

			

			function getPosts() {
				$http.get('/posts').then(function(response){ // $http is a service and .get is it's function

					$scope.posts = response.data; // ***IMP: data extracted from server.js (backend) instead of frontend
				});
			}

			getPosts();
			
		});

	</script>
</head>
<body ng-controller="OinkCtrl">
	<h1 class="page-title">Oink</h1>
	<div class="row feed">
		<div class="col-md-4">
			<h4>Login</h4>
			<input type="text" size="30" placeholder="Username">
			<br><br>
			<input type="password" size="30" placeholder="Password">
		</div>
		<div class="col-md-8">
			<div class="new-post">
				<!-- form-control provides CSS-type (style) control over the button, ng-model is a part of AngularJS -->
				<input type="text" class="form-control" ng-model="newPost" placeholder="What is your new post?">
				<br>
				<button class="btn" type="button" ng-click="submitNewPost()">Submit</button>
			</div>
			<h3 ng-repeat="post in posts"> <!-- like a for-each loop -->
				<span class="glyphicon glyphicon-user" aria-hidden="true"></span>
				{{ post.text }}
				<a href ng-click="removePost(post)"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></a>
			</h3>
		</div>
	</div>


</body>
</html>